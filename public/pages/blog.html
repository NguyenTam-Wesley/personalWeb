<!-- pages/blog.html -->
<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Blog</title>
  <link rel="stylesheet" href="../style/themes.css" />
  <link rel="stylesheet" href="../style/components.css" />
  <link rel="stylesheet" href="../style/blog.css" />
  <link
    rel="icon"
    href="https://calwzopyjitbtahiafzw.supabase.co/storage/v1/object/sign/web-pic/icon/avt_libai.jpg?token=eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV84Mzg1MDYzNy1jNjQwLTQwYjQtYTk0OS1hODY4YmI0Yzk2YmMiLCJhbGciOiJIUzI1NiJ9.eyJ1cmwiOiJ3ZWItcGljL2ljb24vYXZ0X2xpYmFpLmpwZyIsImlhdCI6MTc2NjAzNzcwMywiZXhwIjo4NjU2OTg4MTg1MDN9.1JSZExUNh3_1uiHZ00ayOskz7UX3S3DpVEtKPkKVwu8"
  />
</head>
<body>
  <main class="blog-container">
    <div class="blog-header">
      <h1>üìù Blog</h1>
      <p>Chia s·∫ª ki·∫øn th·ª©c v√† tr·∫£i nghi·ªám</p>
      <div class="blog-controls">
        <button id="createPostBtn" class="btn-primary admin-only" style="display: none;">
          <span class="icon">‚úèÔ∏è</span>
          Vi·∫øt b√†i m·ªõi
        </button>
      </div>
    </div>

    <div class="blog-content">
      <div class="blog-filters">
        <div class="search-box">
          <input type="text" id="searchInput" placeholder="T√¨m ki·∫øm b√†i vi·∫øt..." />
          <span class="search-icon">üîç</span>
        </div>
        <div class="filter-options">
          <select id="topicFilter">
            <option value="">T·∫•t c·∫£ ch·ªß ƒë·ªÅ</option>
            <!-- Topics will be populated by JavaScript -->
          </select>
          <select id="sortFilter">
            <option value="newest">M·ªõi nh·∫•t</option>
            <option value="oldest">C≈© nh·∫•t</option>
            <option value="popular">Xem nhi·ªÅu</option>
            <option value="most_liked">Th√≠ch nhi·ªÅu</option>
          </select>
        </div>
        <div class="tag-filters" id="tagFilters">
          <!-- Tag checkboxes will be populated by JavaScript -->
        </div>
      </div>

      <div class="blog-posts" id="blogPosts">
        <!-- Posts will be loaded here -->
        <div class="loading-spinner">
          <div class="spinner"></div>
          <p>ƒêang t·∫£i b√†i vi·∫øt...</p>
        </div>
      </div>

      <div class="blog-pagination" id="pagination" style="display: none;">
        <button class="pagination-btn" id="prevPage">‚Üê Tr∆∞·ªõc</button>
        <div class="page-numbers" id="pageNumbers"></div>
        <button class="pagination-btn" id="nextPage">Sau ‚Üí</button>
      </div>
    </div>
  </main>

  <!-- Create Post Modal -->
  <div id="createPostModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Vi·∫øt b√†i m·ªõi</h2>
        <button class="close-btn" id="closeCreateModal">&times;</button>
      </div>
      <div class="modal-body">
        <form id="createPostForm">
          <div class="form-row">
            <div class="form-group">
              <label for="postTitle">Ti√™u ƒë·ªÅ b√†i vi·∫øt *</label>
              <input type="text" id="postTitle" name="postTitle" required placeholder="Nh·∫≠p ti√™u ƒë·ªÅ b√†i vi·∫øt" maxlength="200" />
            </div>
            <div class="form-group">
              <label for="postTopic">Ch·ªß ƒë·ªÅ *</label>
              <select id="postTopic" name="postTopic" required>
                <option value="">Ch·ªçn ch·ªß ƒë·ªÅ</option>
                <!-- Topics will be populated by JavaScript -->
              </select>
            </div>
          </div>

          <div class="form-group">
            <label for="postContent">N·ªôi dung b√†i vi·∫øt *</label>
            <div id="postContent" style="height: 300px;"></div>
            <input type="hidden" name="postContent" id="postContentHidden" required>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="postTags">Tags (ph√¢n c√°ch b·∫±ng d·∫•u ph·∫©y)</label>
              <input type="text" id="postTags" name="postTags" placeholder="javascript, react, tutorial" />
            </div>
            <div class="form-group">
              <label for="postStatus">Tr·∫°ng th√°i</label>
              <select id="postStatus" name="postStatus">
                <option value="published">C√¥ng khai</option>
                <option value="draft">B·∫£n nh√°p</option>
              </select>
            </div>
          </div>

          <div class="form-actions">
            <button type="button" class="btn-secondary" id="cancelCreate">H·ªßy</button>
            <button type="submit" class="btn-primary">
              <span class="btn-icon">üìù</span>
              ƒêƒÉng b√†i
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Quill Editor CSS & JS -->
  <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
  <script>
    // Set global flag when Quill loads
    window.QuillLoaded = false;
    var quillScript = document.createElement('script');
    quillScript.src = 'https://cdn.quilljs.com/1.3.6/quill.js';
    quillScript.onload = function() {
      window.QuillLoaded = true;
      console.log('‚úÖ Quill loaded successfully');
    };
    document.head.appendChild(quillScript);
  </script>

  <!-- Load blog script after Quill is ready -->
  <script>
    function loadBlogScript() {
      if (window.QuillLoaded && typeof Quill !== 'undefined') {
        console.log('‚úÖ Quill ready, loading blog script...');
        const script = document.createElement('script');
        script.type = 'module';
        script.src = '../js/modules/blog_entry.js';
        document.head.appendChild(script);
      } else {
        console.log('‚è≥ Waiting for Quill...');
        setTimeout(loadBlogScript, 50);
      }
    }

    // Start checking
    loadBlogScript();
  </script>
</body>
</html> 