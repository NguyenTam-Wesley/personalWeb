<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quill Module Test</title>
    <!-- Quill CSS & JS -->
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>

    <!-- Theme CSS -->
    <link rel="stylesheet" href="./public/style/themes.css">
    <link rel="stylesheet" href="./public/style/variables.css">

    <style>
        body { font-family: Arial, sans-serif; padding: 20px; max-width: 1200px; margin: 0 auto; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
        .editor-container { margin: 20px 0; }
        #test-editor { height: 250px; border: 1px solid #ccc; border-radius: 4px; }
        button { margin: 5px; padding: 8px 16px; background: #4e7cff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        .output { margin-top: 20px; padding: 15px; background: #f9f9f9; border-radius: 4px; }
        .raw-output { background: #f0f0f0; padding: 10px; border-radius: 4px; font-family: monospace; white-space: pre-wrap; max-height: 200px; overflow-y: auto; }
        .theme-toggle { position: fixed; top: 20px; right: 20px; }
    </style>
</head>
<body data-theme="light">
    <h1>üß™ QuillEditor Module Test</h1>

    <button class="theme-toggle" onclick="toggleTheme()">üåô Toggle Theme</button>

    <div class="test-section">
        <h2>Test 1: Basic QuillEditor Usage</h2>
        <div class="editor-container">
            <div id="test-editor"></div>
            <input type="hidden" id="test-hidden">
        </div>
        <button onclick="initEditor()">Initialize Editor</button>
        <button onclick="getContent()">Get Content</button>
        <button onclick="setContent()">Set Test Content</button>
        <button onclick="resetEditor()">Reset</button>
        <div class="output" id="output" style="display: none;"></div>
    </div>

    <div class="test-section">
        <h2>Test 2: Form Integration</h2>
        <form id="test-form">
            <input type="text" placeholder="Title" style="width: 100%; padding: 10px; margin: 10px 0;">
            <div id="form-editor" style="height: 200px;"></div>
            <input type="hidden" id="form-hidden">
            <button type="submit">Submit</button>
        </form>
        <div class="output" id="form-output" style="display: none;"></div>
    </div>

    <script type="module">
        import { QuillEditor } from './public/js/components/quillEditor.js';

        let editor;
        let formEditor;

        function initEditor() {
            if (editor) {
                alert('Editor already initialized!');
                return;
            }

            try {
                editor = new QuillEditor({
                    container: '#test-editor',
                    hiddenInput: '#test-hidden',
                    height: 250,
                    placeholder: 'Test the QuillEditor module...'
                });
                alert('‚úÖ Editor initialized successfully!');
            } catch (error) {
                alert('‚ùå Failed to initialize: ' + error.message);
            }
        }

        function getContent() {
            if (!editor) {
                alert('Editor not initialized!');
                return;
            }

            const html = editor.getHTML();
            const text = editor.getText();

            const output = document.getElementById('output');
            output.innerHTML = `
                <p><strong>HTML Length:</strong> ${html.length} chars</p>
                <p><strong>Text Length:</strong> ${text.length} chars</p>
                <p><strong>Is HTML:</strong> ${html.includes('<') ? '‚úÖ YES' : '‚ùå NO'}</p>
                <h3>Raw HTML:</h3>
                <div class="raw-output">${html}</div>
                <h3>Rendered:</h3>
                <div class="rendered-output" style="border: 1px solid #ddd; padding: 10px; background: white; border-radius: 4px;">${html}</div>
            `;
            output.style.display = 'block';
        }

        function setContent() {
            if (!editor) {
                alert('Editor not initialized!');
                return;
            }

            const testHTML = '<h2>Test Content</h2><p>This is <strong>bold</strong> and <em>italic</em> text.</p><ul><li>Item 1</li><li>Item 2</li></ul>';
            editor.setHTML(testHTML);
            alert('‚úÖ Test content set!');
        }

        function resetEditor() {
            if (!editor) {
                alert('Editor not initialized!');
                return;
            }

            editor.reset();
            document.getElementById('output').style.display = 'none';
            alert('üßπ Editor reset!');
        }

        // Form test
        document.getElementById('test-form').addEventListener('submit', function(e) {
            e.preventDefault();

            const title = this.querySelector('input[type="text"]').value;
            const content = document.getElementById('form-hidden').value;

            const output = document.getElementById('form-output');
            output.innerHTML = `
                <h3>Form Submission Test</h3>
                <p><strong>Title:</strong> ${title}</p>
                <p><strong>Content Length:</strong> ${content.length} chars</p>
                <p><strong>Has HTML:</strong> ${content.includes('<') ? '‚úÖ YES' : '‚ùå NO'}</p>
                <h4>Content:</h4>
                <div class="raw-output">${content}</div>
                <h4>Rendered:</h4>
                <div class="rendered-output" style="border: 1px solid #ddd; padding: 10px; background: white; border-radius: 4px;">${content}</div>
            `;
            output.style.display = 'block';

            alert('‚úÖ Form submitted successfully!');
        });

        // Initialize form editor on load
        setTimeout(() => {
            try {
                formEditor = new QuillEditor({
                    container: '#form-editor',
                    hiddenInput: '#form-hidden',
                    height: 200,
                    placeholder: 'Form editor content...'
                });
            } catch (error) {
                console.error('Failed to initialize form editor:', error);
            }
        }, 1000);

        // Theme toggle function
        window.toggleTheme = function() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', newTheme);

            const button = document.querySelector('.theme-toggle');
            button.textContent = newTheme === 'dark' ? '‚òÄÔ∏è Toggle Theme' : 'üåô Toggle Theme';
        };
    </script>
</body>
</html>