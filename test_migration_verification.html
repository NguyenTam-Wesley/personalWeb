<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Migration Verification</title>
    <!-- Quill CSS & JS -->
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; max-width: 1000px; margin: 0 auto; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
        .editor-container { margin: 20px 0; }
        #editor { height: 200px; border: 1px solid #ccc; border-radius: 4px; }
        button { margin: 5px; padding: 10px 20px; background: #4e7cff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        .output { margin-top: 20px; padding: 15px; background: #f9f9f9; border-radius: 4px; }
        .raw-output { background: #f0f0f0; padding: 10px; border-radius: 4px; font-family: monospace; white-space: pre-wrap; max-height: 200px; overflow-y: auto; }
        .rendered-output { border: 1px solid #ddd; padding: 15px; background: white; border-radius: 4px; }
        .status { padding: 10px; margin: 10px 0; border-radius: 4px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <h1>üß™ Quill Migration Verification</h1>

    <div class="test-section">
        <h2>Test 1: Basic Quill Functionality</h2>
        <div class="editor-container">
            <div id="editor">
                <h1>Test Heading</h1>
                <p>This is <strong>bold</strong> and <em>italic</em> text.</p>
                <ul><li>Bullet 1</li><li>Bullet 2</li></ul>
            </div>
        </div>
        <button onclick="testBasicFunctionality()">Test Basic Functionality</button>
        <button onclick="clearEditor()">Clear</button>
        <div class="output" id="basic-output" style="display: none;"></div>
    </div>

    <div class="test-section">
        <h2>Test 2: HTML Output Verification</h2>
        <button onclick="testHtmlOutput()">Test HTML Output</button>
        <div class="output" id="html-output" style="display: none;"></div>
    </div>

    <div class="test-section">
        <h2>Test 3: Form Integration Test</h2>
        <form id="test-form">
            <input type="text" id="test-title" placeholder="Test Title" style="width: 100%; padding: 10px; margin: 10px 0;">
            <div id="content-editor" style="height: 150px;"></div>
            <input type="hidden" id="content-hidden">
            <button type="submit">Submit Test</button>
        </form>
        <div class="output" id="form-output" style="display: none;"></div>
    </div>

    <script>
        let quill, contentQuill;

        // Initialize main test editor
        const toolbarOptions = [
            [{ 'header': [1, 2, false] }],
            ['bold', 'italic', 'underline'],
            [{ 'list': 'ordered'}, { 'list': 'bullet' }],
            ['link'],
            ['clean']
        ];

        quill = new Quill('#editor', {
            theme: 'snow',
            modules: {
                toolbar: toolbarOptions
            },
            placeholder: 'Type here to test Quill...',
            readOnly: false
        });

        // Initialize content editor for form test
        contentQuill = new Quill('#content-editor', {
            theme: 'snow',
            modules: {
                toolbar: toolbarOptions
            },
            placeholder: 'Form content...',
            readOnly: false
        });

        // Sync content editor to hidden input
        contentQuill.on('text-change', () => {
            const hiddenInput = document.getElementById('content-hidden');
            if (hiddenInput) {
                hiddenInput.value = contentQuill.root.innerHTML;
            }
        });

        function showStatus(message, type = 'info', containerId = 'status') {
            const container = document.getElementById(containerId) || document.body;
            let statusDiv = container.querySelector('.status');
            if (!statusDiv) {
                statusDiv = document.createElement('div');
                statusDiv.className = 'status';
                container.appendChild(statusDiv);
            }
            statusDiv.className = `status ${type}`;
            statusDiv.textContent = message;
        }

        function testBasicFunctionality() {
            if (!quill) {
                showStatus('‚ùå Quill not initialized!', 'error');
                return;
            }

            const output = document.getElementById('basic-output');
            output.innerHTML = `
                <p><strong>Editor Initialized:</strong> ‚úÖ YES</p>
                <p><strong>ReadOnly Mode:</strong> ${quill.options.readOnly ? '‚ùå YES' : '‚úÖ NO'}</p>
                <p><strong>Theme:</strong> ${quill.options.theme}</p>
                <p><strong>Toolbar:</strong> ${quill.options.modules.toolbar ? '‚úÖ YES' : '‚ùå NO'}</p>
                <p><strong>Content Length:</strong> ${quill.getText().length} characters</p>
            `;
            output.style.display = 'block';
            showStatus('‚úÖ Basic functionality test passed!', 'success');
        }

        function testHtmlOutput() {
            if (!quill) {
                showStatus('‚ùå Quill not initialized!', 'error');
                return;
            }

            const htmlContent = quill.root.innerHTML;
            const textContent = quill.getText();

            const output = document.getElementById('html-output');
            output.innerHTML = `
                <p><strong>Is HTML:</strong> ${htmlContent.includes('<') ? '‚úÖ YES' : '‚ùå NO'}</p>
                <p><strong>HTML Length:</strong> ${htmlContent.length} chars</p>
                <p><strong>Text Length:</strong> ${textContent.length} chars</p>
                <h3>Raw HTML:</h3>
                <div class="raw-output">${htmlContent}</div>
                <h3>Rendered:</h3>
                <div class="rendered-output">${htmlContent}</div>
                <h3>Plain Text:</h3>
                <div class="raw-output">${textContent}</div>
            `;
            output.style.display = 'block';
            showStatus('‚úÖ HTML output test passed!', 'success');
        }

        function clearEditor() {
            if (quill) {
                quill.setContents([]);
                document.getElementById('basic-output').style.display = 'none';
                document.getElementById('html-output').style.display = 'none';
                showStatus('üßπ Editor cleared', 'success');
            }
        }

        // Form submission test
        document.getElementById('test-form').addEventListener('submit', function(e) {
            e.preventDefault();

            const title = document.getElementById('test-title').value;
            const content = document.getElementById('content-hidden').value;

            const output = document.getElementById('form-output');
            output.innerHTML = `
                <h3>Form Submission Test</h3>
                <p><strong>Title:</strong> ${title}</p>
                <p><strong>Content HTML:</strong> ${content.includes('<') ? '‚úÖ YES' : '‚ùå NO'}</p>
                <p><strong>Content Length:</strong> ${content.length} chars</p>
                <h4>Raw Content:</h4>
                <div class="raw-output">${content}</div>
                <h4>Rendered Content:</h4>
                <div class="rendered-output">${content}</div>
            `;
            output.style.display = 'block';
            showStatus('‚úÖ Form integration test passed!', 'success');
        });

        // Auto show success status
        setTimeout(() => {
            if (typeof Quill !== 'undefined') {
                showStatus('‚úÖ Quill loaded successfully!', 'success');
            } else {
                showStatus('‚ùå Quill failed to load!', 'error');
            }
        }, 500);
    </script>
</body>
</html>